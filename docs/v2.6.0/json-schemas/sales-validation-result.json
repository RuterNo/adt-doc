{
  "$id": "https://schemas.ruter.no/adt/ota/api/v2.1/proprietary-extensions/sales-validation-result.json",
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "SalesValidationResult",
  "type": "object",
  "description": "Validation result message generated by RuterSalg after validation of Travel card ticket. This topic is intended as a live view of validation count and results. ",
  "required": [
    "eventTimestamp",
    "buzzerCommand",
    "inspectionResult",
    "ledCommand"
  ],
  "properties": {
    "eventTimestamp": {
      "$id": "#/properties/timestamp",
      "type": "string",
      "description": "ISO 8601, UTC. The time of this diagnostics message generation",
      "format": "string"
    },
    "buzzerCommand": {
      "$id": "#/properties/buzzerCommand",
      "type": "object",
      "description": "Buzzer sound result of validation",
      "required": [
        "duration",
        "frequency",
        "pause",
        "repeat"
      ],
      "properties": {
        "duration": {
          "$id": "#/properties/buzzerCommand/properties/duration",
          "type": "integer",
          "description": "The duration of each buzz in ms"
        },
        "frequency": {
          "$id": "#/properties/buzzerCommand/properties/frequency",
          "type": "integer",
          "description": "Frequency to be used for buzzes"
        },
        "pause": {
          "$id": "#/properties/buzzerCommand/properties/pause",
          "type": "integer",
          "description": "Pause between each buzz in ms"
        },
        "repeat": {
          "$id": "#/properties/buzzerCommand/properties/repeat",
          "type": "integer",
          "description": "The number of times the buzz should be repeated"
        }
      }
    },
    "inspectionResult": {
      "$id": "#/properties/inspectionResult",
      "type": "object",
      "description": "The result of the inspection",
      "title": "InspectionResult",
      "required": [
        "code",
        "message",
        "validity"
      ],
      "properties": {
        "code": {
          "$id": "#/properties/inspectionResult/properties/code",
          "type": "integer",
          "title": "Validity code returned by NOD"
        },
        "message": {
          "$id": "#/properties/inspectionResult/properties/message",
          "type": "string",
          "description": "Message to be displayed to user"
        },
        "validity": {
          "$id": "#/properties/inspectionResult/properties/validity",
          "type": "string",
          "description": "Can be either VALID or INVALID, might change in the future (by for example adding an UNKNOWN for students/seniors)",
          "examples": [
            "VALID",
            "INVALID"
          ]
        }
      }
    },
    "ledCommand": {
      "$id": "#/properties/ledCommand",
      "type": "object",
      "title": "Validation result LED commands",
      "required": [
        "color",
        "duration",
        "pause",
        "repeat"
      ],
      "properties": {
        "color": {
          "$id": "#/properties/ledCommand/properties/color",
          "type": "string",
          "description": "Color to be displayed (\"red\" and \"green\" are the possible values as of now)",
          "examples": [
            "red",
            "green"
          ]
        },
        "duration": {
          "$id": "#/properties/ledCommand/properties/duration",
          "type": "integer",
          "description": "Duration in ms the color should be displayed"
        },
        "pause": {
          "$id": "#/properties/ledCommand/properties/pause",
          "type": "integer",
          "description": "How long the pause should be between each time the color is displayed"
        },
        "repeat": {
          "$id": "#/properties/ledCommand/properties/repeat",
          "type": "integer",
          "description": "The number of times the color should be displayed"
        }
      }
    }
  },
  "examples": [
    {
      "eventTimestamp": "2020-04-28T06:38:45.219Z",
      "inspectionResult": {
        "code": 205,
        "message": "Billett Aktivert 28/04/2020 09:38 Enkeltbillett 1 Voksen ",
        "validity": "VALID"
      },
      "ledCommand": {
        "color": "green",
        "duration": 5000,
        "pause": 50,
        "repeat": 1
      },
      "buzzerCommand": {
        "frequency": 1320,
        "duration": 200,
        "pause": 50,
        "repeat": 1
      }
    }
  ]
}
